(function(d,f){typeof exports=="object"&&typeof module!="undefined"?module.exports=f():typeof define=="function"&&define.amd?define(f):(d=typeof globalThis!="undefined"?globalThis:d||self,d.VueSnip=f())})(this,function(){"use strict";function d(n,r){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);r&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,t)}return e}function f(n){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?d(Object(e),!0).forEach(function(t){v(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function v(n,r,e){return r in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function w(n,r){if(!!n){if(typeof n=="string")return y(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return y(n,r)}}function y(n,r){(r==null||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function L(n,r){var e=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=w(n))||r&&n&&typeof n.length=="number"){e&&(n=e);var t=0,i=function(){};return{s:i,n:function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}},e:function(o){throw o},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,s;return{s:function(){e=e.call(n)},n:function(){var o=e.next();return a=o.done,o},e:function(o){u=!0,s=o},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(u)throw s}}}}var m={directiveName:"snip",snipMethod:"css",maxLines:3,separators:[". ",", "," ",""],ellipsis:".\u200A.\u200A.",debugMode:!1,exposeSnipFunction:!1,snipFunctionName:"snipText"},j=function(r,e){var t=r.elementMap.get(e),i=t.fullText,a=t.maxLines;e.textContent=i,e.style.display="-webkit-box",e.style.webkitLineClamp=a,e.style.webkitBoxOrient="vertical",e.style.overflow="hidden"},C=1.2,g=function(r){var e=window.getComputedStyle(r),t=parseInt(e.height),i=e.lineHeight==="normal"?parseInt(e.fontSize)*C:parseInt(e.lineHeight);return t===0&&i===0?0:Math.ceil(t/i)},I=function(r,e){var t=r.elementMap.get(e),i=t.fullText,a=t.maxLines,u=r.options,s=u.ellipsis,o=u.separators;if(e.textContent=i,e.style.display=null,e.style.webkitLineClamp=null,e.style.webkitBoxOrient=null,e.style.overflow=null,!(a<=0||g(e)<=a)){var p={unprocessed:i,processed:""};o.forEach(function(c){var l=L(p.unprocessed.split(c)),O;try{for(l.s();!(O=l.n()).done;){var b=O.value;if(e.textContent="".concat(p.processed).concat(b).concat(c).concat(s),g(e)>a){p.unprocessed=b;break}p.processed="".concat(p.processed).concat(b).concat(c)}}catch(z){l.e(z)}finally{l.f()}}),e.textContent="".concat(p.processed.trim()).concat(s)}},T=function(r){return function(e){var t=r.elementMap.get(e);if(t.snipMethod==="css"){j(r,e);return}t.snipMethod==="js"&&(I(r,e),t.prevWidth=e.clientWidth,t.prevHeight=e.clientHeight)}},h=function(r,e){var t=parseInt(e);if(!isNaN(t))return t;var i=r.options.maxLines,a=parseInt(i);return isNaN(a)?m.maxLines:a},_=function(){return typeof CSS!="undefined"&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","3")&&CSS.supports("-webkit-box-orient","vertical")},S=function(r,e){if(!_())return"js";if(e==="css"||e==="js")return e;var t=r.options.snipMethod;return t==="css"||t==="js"?t:m.snipMethod},x=function(r,e,t){var i=r.elementMap.get(t),a=i.observer||new ResizeObserver(function(){(t.clientWidth!==i.prevWidth||t.clientHeight!==i.prevHeight)&&e(t)});a.observe(t),i.observer=a},M=function(r,e){var t=r.elementMap.get(e);t.observer&&t.observer.disconnect(),t.observer&&delete t.prevWidth,t.observer&&delete t.prevHeight,t.observer&&delete t.observer},H=function(r,e){return function(t,i){var a=i.value,u=i.arg,s=r.elementMap,o={fullText:t.textContent,maxLines:h(r,a),snipMethod:S(r,u)};s.set(t,o);var p=o.snipMethod==="js";p&&typeof ResizeObserver!="undefined"?x(r,e,t):e(t)}},A=function(r,e){return function(t,i){var a=i.value,u=i.arg,s=r.elementMap.get(t),o=s.maxLines,p=s.snipMethod;s.maxLines=h(r,a),s.snipMethod=S(r,u);var c=s.snipMethod==="js";c&&typeof ResizeObserver!="undefined"?x(r,e,t):M(r,t);var l=o!==s.maxLines||p!==s.snipMethod&&s.snipMethod==="css";l&&e(t)}},P=function(r){return function(e){var t=r.elementMap;M(r,e),t.delete(e)}},N={install:function(r,e){var t;e=f(f({},m),e);var i=new WeakMap,a={elementMap:i,options:e},u=T(a),s=H(a,u),o=A(a,u),p=P(a),c=r.version[0]>2;r.directive(e.directiveName,(t={},v(t,c?"mounted":"inserted",s),v(t,c?"updated":"update",o),v(t,c?"unmounted":"unbind",p),t)),e.exposeSnipFunction&&(r.prototype["$".concat(e.snipFunctionName)]=u),e.debugMode&&(window.__VueSnipState=a)}};return N});
