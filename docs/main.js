(function(c,a){typeof exports=="object"&&typeof module!="undefined"?module.exports=a():typeof define=="function"&&define.amd?define(a):(c=typeof globalThis!="undefined"?globalThis:c||self,c.VueSnip=a())})(this,function(){"use strict";const c={directiveName:"snip",snipMethod:"css",maxLines:3,separators:[". ",", "," ",""],ellipsis:".\u200A.\u200A.",debugMode:!1,exposeSnipFunction:!1,snipFunctionName:"snipText"},a=(n,e)=>{const{fullText:t,maxLines:s}=n.elementMap.get(e);e.textContent=t,e.style.display="-webkit-box",e.style.webkitLineClamp=s,e.style.webkitBoxOrient="vertical",e.style.overflow="hidden"},M=1.2,l=n=>{const e=window.getComputedStyle(n),t=parseFloat(e.height),s=e.lineHeight==="normal"?parseFloat(e.fontSize)*M:parseFloat(e.lineHeight);return t===0&&s===0?0:Math.ceil(t/s)},S=(n,e)=>{const{fullText:t,maxLines:s}=n.elementMap.get(e),{ellipsis:o,separators:i}=n.options;if(e.textContent=t,e.style.display=null,e.style.webkitLineClamp=null,e.style.webkitBoxOrient=null,e.style.overflow=null,s<=0||l(e)<=s)return;const r={unprocessed:t,processed:""};i.forEach(p=>{for(const d of r.unprocessed.split(p)){if(e.textContent=`${r.processed}${d}${p}${o}`,l(e)>s){r.unprocessed=d;break}r.processed=`${r.processed}${d}${p}`}}),e.textContent=`${r.processed.trim()}${o}`},g=n=>e=>{const t=n.elementMap.get(e);if(t.snipMethod==="css"){a(n,e);return}t.snipMethod==="js"&&(S(n,e),t.prevWidth=e.clientWidth,t.prevHeight=e.clientHeight)},u=(n,e)=>{const t=parseInt(e);if(!isNaN(t))return t;const{maxLines:s}=n.options,o=parseInt(s);return isNaN(o)?c.maxLines:o},y=()=>typeof CSS!="undefined"&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","3")&&CSS.supports("-webkit-box-orient","vertical"),f=(n,e)=>{if(!y())return"js";if(e==="css"||e==="js")return e;const{snipMethod:t}=n.options;return t==="css"||t==="js"?t:c.snipMethod},m=(n,e,t)=>{const s=n.elementMap.get(t),o=s.observer||new ResizeObserver(()=>{(t.clientWidth!==s.prevWidth||t.clientHeight!==s.prevHeight)&&e(t)});o.observe(t),s.observer=o},v=(n,e)=>{const t=n.elementMap.get(e);t.observer&&t.observer.disconnect(),t.observer&&delete t.prevWidth,t.observer&&delete t.prevHeight,t.observer&&delete t.observer},w=(n,e)=>(t,{value:s,arg:o})=>{const{elementMap:i}=n,r={fullText:t.textContent,maxLines:u(n,s),snipMethod:f(n,o)};i.set(t,r),r.snipMethod==="js"&&typeof ResizeObserver!="undefined"?m(n,e,t):e(t)},O=(n,e)=>(t,{value:s,arg:o})=>{const i=n.elementMap.get(t),r=i.maxLines,p=i.snipMethod;i.maxLines=u(n,s),i.snipMethod=f(n,o),i.snipMethod==="js"&&typeof ResizeObserver!="undefined"?m(n,e,t):v(n,t),(r!==i.maxLines||p!==i.snipMethod&&i.snipMethod==="css")&&e(t)},L=n=>e=>{const{elementMap:t}=n;v(n,e),t.delete(e)};var _=Object.defineProperty,b=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,h=(n,e,t)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,x=(n,e)=>{for(var t in e||(e={}))C.call(e,t)&&h(n,t,e[t]);if(b)for(var t of b(e))H.call(e,t)&&h(n,t,e[t]);return n},$={install(n,e){e=x(x({},c),e);const s={elementMap:new WeakMap,options:e},o=g(s),i=w(s,o),r=O(s,o),p=L(s),d=n.version[0]>2;n.directive(e.directiveName,{[d?"mounted":"inserted"]:i,[d?"updated":"update"]:r,[d?"unmounted":"unbind"]:p}),e.exposeSnipFunction&&(n.prototype[`$${e.snipFunctionName}`]=o),e.debugMode&&(window.__VueSnipState=s)}};return $});
