!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).VueSnip=t()}(this,(function(){"use strict";const e={directiveName:"snip",snipMethod:"css",maxLines:3,separators:[". ",", "," ",""],ellipsis:". . .",debugMode:!1,exposeSnipFunction:!1,snipFunctionName:"snipText"},t=e=>{const t=window.getComputedStyle(e),s=parseFloat(t.height),n="normal"===t.lineHeight?1.2*parseFloat(t.fontSize):parseFloat(t.lineHeight);return 0===s&&0===n?0:Math.ceil(s/n)},s=e=>s=>{const n=e.elementMap.get(s);"css"!==n.snipMethod?"js"===n.snipMethod&&(((e,s)=>{const{fullText:n,maxLines:i}=e.elementMap.get(s),{ellipsis:o,separators:r}=e.options;if(s.textContent=n,s.style.display=null,s.style.webkitLineClamp=null,s.style.webkitBoxOrient=null,s.style.overflow=null,i<=0||t(s)<=i)return;const p={unprocessed:n,processed:""};r.forEach((e=>{for(const n of p.unprocessed.split(e)){if(s.textContent=`${p.processed}${n}${e}${o}`,t(s)>i){p.unprocessed=n;break}p.processed=`${p.processed}${n}${e}`}})),s.textContent=`${p.processed.trim()}${o}`})(e,s),n.prevWidth=s.clientWidth,n.prevHeight=s.clientHeight):((e,t)=>{const{fullText:s,maxLines:n}=e.elementMap.get(t);t.textContent=s,t.style.display="-webkit-box",t.style.webkitLineClamp=n,t.style.webkitBoxOrient="vertical",t.style.overflow="hidden"})(e,s)},n=(t,s)=>{const n=parseInt(s);if(!isNaN(n))return n;const{maxLines:i}=t.options,o=parseInt(i);return isNaN(o)?e.maxLines:o},i=(t,s)=>{if(!("undefined"!=typeof CSS&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","3")&&CSS.supports("-webkit-box-orient","vertical")))return"js";if("css"===s||"js"===s)return s;const{snipMethod:n}=t.options;return"css"===n||"js"===n?n:e.snipMethod},o=(e,t,s)=>{const n=e.elementMap.get(s),i=n.observer||new ResizeObserver((()=>{s.clientWidth===n.prevWidth&&s.clientHeight===n.prevHeight||t(s)}));i.observe(s),n.observer=i},r=(e,t)=>{const s=e.elementMap.get(t);s.observer&&s.observer.disconnect(),s.observer&&delete s.prevWidth,s.observer&&delete s.prevHeight,s.observer&&delete s.observer};return{install(t,p){p={...e,...p};const l={elementMap:new WeakMap,options:p},d=s(l),a=((e,t)=>(s,{value:r,arg:p})=>{const{elementMap:l}=e,d={fullText:s.textContent,maxLines:n(e,r),snipMethod:i(e,p)};l.set(s,d),"js"===d.snipMethod&&"undefined"!=typeof ResizeObserver?o(e,t,s):t(s)})(l,d),c=((e,t)=>(s,{value:p,arg:l})=>{const d=e.elementMap.get(s),a=d.maxLines,c=d.snipMethod;d.maxLines=n(e,p),d.snipMethod=i(e,l),"js"===d.snipMethod&&"undefined"!=typeof ResizeObserver?o(e,t,s):r(e,s),(a!==d.maxLines||c!==d.snipMethod&&"css"===d.snipMethod)&&t(s)})(l,d),u=(e=>t=>{const{elementMap:s}=e;r(e,t),s.delete(t)})(l),f=t.version[0]>2;t.directive(p.directiveName,{[f?"mounted":"inserted"]:a,[f?"updated":"update"]:c,[f?"unmounted":"unbind"]:u}),p.exposeSnipFunction&&(t.prototype[`$${p.snipFunctionName}`]=d),p.debugMode&&(globalThis.__VueSnipState=l)}}}));
