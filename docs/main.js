!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).VueSnip=t()}(this,(function(){"use strict";const e={directiveName:"snip",snipMethod:"css",maxLines:3,separators:[". ",", "," ",""],ellipsis:". . .",debugMode:!1,exposeSnipFunction:!1,snipFunctionName:"snipText"},t=e=>{const t=window.getComputedStyle(e),n=parseFloat(t.height),s="normal"===t.lineHeight?1.2*parseFloat(t.fontSize):parseFloat(t.lineHeight);return 0===n&&0===s?0:Math.ceil(n/s)},n=e=>n=>{const s=e.elementMap.get(n);"css"!==s.snipMethod?"js"===s.snipMethod&&(((e,n)=>{const{fullText:s,maxLines:i}=e.elementMap.get(n),{ellipsis:o,separators:r}=e.options;if(n.textContent=s,n.style.display=null,n.style.webkitLineClamp=null,n.style.webkitBoxOrient=null,n.style.overflow=null,i<=0||t(n)<=i)return;const p={unprocessed:s,processed:""};r.forEach((e=>{for(const s of p.unprocessed.split(e)){if(n.textContent=`${p.processed}${s}${e}${o}`,t(n)>i){p.unprocessed=s;break}p.processed=`${p.processed}${s}${e}`}})),n.textContent=`${p.processed.trim()}${o}`})(e,n),s.prevWidth=n.clientWidth,s.prevHeight=n.clientHeight):((e,t)=>{const{fullText:n,maxLines:s}=e.elementMap.get(t);t.textContent=n,t.style.display="-webkit-box",t.style.webkitLineClamp=s,t.style.webkitBoxOrient="vertical",t.style.overflow="hidden"})(e,n)},s=(t,n)=>{const s=parseInt(n);if(!isNaN(s))return s;const{maxLines:i}=t.options,o=parseInt(i);return isNaN(o)?e.maxLines:o},i=(t,n)=>{if(!("undefined"!=typeof CSS&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","3")&&CSS.supports("-webkit-box-orient","vertical")))return"js";if("css"===n||"js"===n)return n;const{snipMethod:s}=t.options;return"css"===s||"js"===s?s:e.snipMethod},o=(e,t,n)=>{const s=e.elementMap.get(n),i=s.observer||new ResizeObserver((()=>{n.clientWidth===s.prevWidth&&n.clientHeight===s.prevHeight||t(n)}));i.observe(n),s.observer=i},r=(e,t)=>{const n=e.elementMap.get(t);n.observer&&n.observer.disconnect(),n.observer&&delete n.prevWidth,n.observer&&delete n.prevHeight,n.observer&&delete n.observer};return{install(t,p){p={...e,...p};const l={elementMap:new WeakMap,options:p},d=n(l),a=((e,t)=>(n,{value:r,arg:p})=>{const{elementMap:l}=e,d={fullText:n.textContent,maxLines:s(e,r),snipMethod:i(e,p)};l.set(n,d),"js"===d.snipMethod&&"undefined"!=typeof ResizeObserver?o(e,t,n):t(n)})(l,d),c=((e,t)=>(n,{value:p,arg:l})=>{const d=e.elementMap.get(n),a=d.maxLines,c=d.snipMethod;d.maxLines=s(e,p),d.snipMethod=i(e,l),"js"===d.snipMethod&&"undefined"!=typeof ResizeObserver?o(e,t,n):r(e,n),(a!==d.maxLines||c!==d.snipMethod&&"css"===d.snipMethod)&&t(n)})(l,d),u=(e=>t=>{const{elementMap:n}=e;r(e,t),n.delete(t)})(l),f=t.version[0]>2;t.directive(p.directiveName,{[f?"mounted":"inserted"]:a,[f?"updated":"update"]:c,[f?"unmounted":"unbind"]:u}),p.exposeSnipFunction&&(t.prototype[`$${p.snipFunctionName}`]=d),p.debugMode&&(window.__VueSnipState=l)}}}));
