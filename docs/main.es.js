const d={directiveName:"snip",snipMethod:"css",maxLines:3,separators:[". ",", "," ",""],ellipsis:".\u200A.\u200A.",debugMode:!1,exposeSnipFunction:!1,snipFunctionName:"snipText"},M=(n,e)=>{const{fullText:t,maxLines:s}=n.elementMap.get(e);e.textContent=t,e.style.display="-webkit-box",e.style.webkitLineClamp=s,e.style.webkitBoxOrient="vertical",e.style.overflow="hidden"},x=1.2,a=n=>{const e=window.getComputedStyle(n),t=parseInt(e.height),s=e.lineHeight==="normal"?parseInt(e.fontSize)*x:parseInt(e.lineHeight);return t===0&&s===0?0:Math.ceil(t/s)},S=(n,e)=>{const{fullText:t,maxLines:s}=n.elementMap.get(e),{ellipsis:r,separators:o}=n.options;if(e.textContent=t,e.style.display=null,e.style.webkitLineClamp=null,e.style.webkitBoxOrient=null,e.style.overflow=null,s<=0||a(e)<=s)return;const i={unprocessed:t,processed:""};o.forEach(p=>{for(const c of i.unprocessed.split(p)){if(e.textContent=`${i.processed}${c}${p}${r}`,a(e)>s){i.unprocessed=c;break}i.processed=`${i.processed}${c}${p}`}}),e.textContent=`${i.processed.trim()}${r}`},g=n=>e=>{const t=n.elementMap.get(e);if(t.snipMethod==="css"){M(n,e);return}t.snipMethod==="js"&&(S(n,e),t.prevWidth=e.clientWidth,t.prevHeight=e.clientHeight)},l=(n,e)=>{const t=parseInt(e);if(!isNaN(t))return t;const{maxLines:s}=n.options,r=parseInt(s);return isNaN(r)?d.maxLines:r},y=()=>typeof CSS!="undefined"&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","3")&&CSS.supports("-webkit-box-orient","vertical"),u=(n,e)=>{if(!y())return"js";if(e==="css"||e==="js")return e;const{snipMethod:t}=n.options;return t==="css"||t==="js"?t:d.snipMethod},m=(n,e,t)=>{const s=n.elementMap.get(t),r=s.observer||new ResizeObserver(()=>{(t.clientWidth!==s.prevWidth||t.clientHeight!==s.prevHeight)&&e(t)});r.observe(t),s.observer=r},v=(n,e)=>{const t=n.elementMap.get(e);t.observer&&t.observer.disconnect(),t.observer&&delete t.prevWidth,t.observer&&delete t.prevHeight,t.observer&&delete t.observer},w=(n,e)=>(t,{value:s,arg:r})=>{const{elementMap:o}=n,i={fullText:t.textContent,maxLines:l(n,s),snipMethod:u(n,r)};o.set(t,i),i.snipMethod==="js"&&typeof ResizeObserver!="undefined"?m(n,e,t):e(t)},O=(n,e)=>(t,{value:s,arg:r})=>{const o=n.elementMap.get(t),i=o.maxLines,p=o.snipMethod;o.maxLines=l(n,s),o.snipMethod=u(n,r),o.snipMethod==="js"&&typeof ResizeObserver!="undefined"?m(n,e,t):v(n,t),(i!==o.maxLines||p!==o.snipMethod&&o.snipMethod==="css")&&e(t)},L=n=>e=>{const{elementMap:t}=n;v(n,e),t.delete(e)};var _=Object.defineProperty,f=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,b=(n,e,t)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,h=(n,e)=>{for(var t in e||(e={}))C.call(e,t)&&b(n,t,e[t]);if(f)for(var t of f(e))H.call(e,t)&&b(n,t,e[t]);return n},$={install(n,e){e=h(h({},d),e);const s={elementMap:new WeakMap,options:e},r=g(s),o=w(s,r),i=O(s,r),p=L(s),c=n.version[0]>2;n.directive(e.directiveName,{[c?"mounted":"inserted"]:o,[c?"updated":"update"]:i,[c?"unmounted":"unbind"]:p}),e.exposeSnipFunction&&(n.prototype[`$${e.snipFunctionName}`]=r),e.debugMode&&(window.__VueSnipState=s)}};export{$ as default};
